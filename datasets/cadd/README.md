# Combined Annotation-Dependent Depletion (CADD)

CADD is a method for integrating genomic variant (SNV and small indel) annotations into a single metric (C score) for each position in the human genome. CADD is based on “contrasting the annotations of fixed or nearly fixed derived alleles in humans relative to simulated variants”.

A total of ~50M pathogenic variants (44.18M SNVs, 2.1M insertions, 3.1 deletions) were generated using a genome-wide simulator of de novo germline variation. For the benign variants (referred to as observed and HCdiff in the paper), sites were selected that underwent many generations of purifying selection. Variants with derived allele frequencies >= 95% in the 1000G data were selected. A total of ~17M variants (14.89 SNVs, 627K insertions, 1.1M deletions) were extracted.

Ten datasets were generated by sampling 13,1M SNVs, 627K insertions, 927K deletions from both the simulated and observed variant datasets. 99% of the variants were used to train the linear SVM and 1% were used for testing.

A number of real datasets were obtained for testing the model. One inparticular is the ClinVar pathogenic with ESP variants serving as benign. The supplemental file details how these datsets were generated:

> We obtained the ClinVar data set (release date June 16 2012, ftp://ftp.ncbi.nih.gov/snp/organisms/ human_9606/VCF/clinvar_00-latest.vcf.gz) from the American National Center for Biotechnology Information (NCBI). We extracted variants that were marked "pathogenic" or "non-pathogenic (benign)". However, we noticed that the benign variation had a very different composition in terms of the Consequence annotation compared to the pathogenic variation. Due to the restriction of the most predictive publically available scores (i.e. PolyPhen, SIFT) to non-synonymous changes, those scores were underrepresented in the benign set. We therefore selected a set of apparently benign (≥5% allele frequency) variants from ESP that were matched to the pathogenic ClinVar sites in terms of their Consequence annotations. In addition, we generated a data set where we matched ESP and ClinVar frequencies to three decimal precisions of the alternative allele frequency. Further, due to the overlap of ClinVar and ESP variants with the PolyPhen training data set, we trained a separate 42
classifier without the PolyPhen features and we also checked the performance on the subset of ClinVar and ESP variants not used for PolyPhen training. To compare the performance of CADD with other publically available missense annotations not used in model training, we downloaded scores from dbNSFP 2.05. Finally, we analyzed ClinVar pathogenic variants in the context of the eleven men data (see below). Results for these analyses are presented in Fig. 3 as well as Supplementary Figs. 12-16. The ClinVar pathogenic variants used here are 76% missense, 18% nonsense, 3% splice site events, 1% frameshift indels and 2% other (and ESP benign variants were always matched to the same distribution of categorical consequences).


## Features

The [supplemental file](http://www.ncbi.nlm.nih.gov/pmc/articles/PMC3992975/bin/NIHMS555958-supplement-1.pdf) contains all the documentation for the original features used in the CADD variant annotation. In short, the authors included features related to conservation metrics (GERP, phastCons, phyloP), regulatory information (DNase hypersensitivity regions, transcription factor binding sites), transcript information (distance to exon-intron boundaries or experssion levels in cell lines), and protein-level scores (Grantham, SIFT, PolyPhen). There were 63 distinct annotations from multiple data sources (VEP, ENCODE, UCSC) in version 1.0. Since version 1.0, there have been additional features added, which they re-trained their model and generated updated scores. See the [website](http://cadd.gs.washington.edu/info) for the update and release notes. Of note, in v1.1 and all subsequent versions, additional ENCODE data, predicted local DNA secondary structure effects, predicted microRNA binding sites from mirSVR, genomewide mutability index, and a "reduced-level" representation from the protein domain annotations from VEP.

## Imputation and data preprocessing for modeling

The authors detail how they preprocess the feature set before using it in the SVM model. The supplemental file has a section on it that I will summarize here.

Columns that are not useful and removed:
  * Chrom, Pos, AnnoType, ConsScore, ConsDetail, motifEName, GeneID, FeatureID, CCDS, GeneName, Exon, Intron

Columns that will differentiate the simulated deleterious variants from the observed benign variants and need to be exluded:
  * Anc, isDerived, mapAbility20bp, mapAbility35bp, scoreSegDup, known variation status and ESP/1000G frequency information.
  * No allele frequence information was used in the model training.

Missing values for a set of annotations were imputed or set to 0 in order to fit the models (Supplemental Table 2):
  * Missing values for genomewide values were imputed with the genome maverage obtained from the simulated data.
  * Missing values were set to zero where appropriate.

An undefined cateogry was created for categorical annotations in order to accomodate missing values:
  * Segway, oAA, nAA, PolyPhenCat, SIFTcat, Dst2SplType

Missing values in annotations not defined on a subset of variants were set to 0 and an indicator variable created that contain a 1 if the corresponding variant is undefined and 0 otherwise:
  * cDNApos, relcDNApos, CDSpos, relCDSpos, protPos, relProtPos, Grantham, PolyPhenVal, SIFTval, Dst2Splice ACCEPTOR and DONOR

## Links and data sources:
  * [Publication](http://www.ncbi.nlm.nih.gov/pubmed/24487276)
  * [Supplemental file](http://www.ncbi.nlm.nih.gov/pmc/articles/PMC3992975/bin/NIHMS555958-supplement-1.pdf)
  * [Website](http://cadd.gs.washington.edu/) - main website with information, files and online submission for scoring (and annotating) up to 100,000 variants.
  * [Data source 1](http://krishna.gs.washington.edu/members/mkircher/download/CADD/) - files server for the CADD website.
  * [Data source 2](http://krishna.gs.washington.edu/members/mkircher/download/CADD/)

### Data source 2

A file server specifically linked to the first author. This source contains the updated (CADD v1.3) files, fully annotated testing and training datasets as well as the simulated and observed variant sites in vcf format. The testing and training files available are:
  * test.csv.gz - File contains the "imputed" data matrix with  rows and  columns. The documentation
  * train.csv.gz - File contains the "imputed" data matrix with  rows and 103 columns. 
  * training_data.tsv.gz - File contains the "non-imputed" data matrix with all the training sites and v1.3 featureset. There are 35043061 rows and 103 columns.

Note that for the response variable, pathogenic or simulated sites were labelled as +1 and the observed or benign variants are labelled as -1.
